\cpgefont{lmodern}
\RequirePackage{parskip}
\RequirePackage{tikz}

\Preauteur{Corrigé proposé par~}
\AtBeginDocument{\@bsphack
\cpgesettitle{
    \ifdefmeta{document}
        {|document| \par \vskip\dimexpr\bigskipamount*3}{}
    \ifdefmeta{concours}
        {|concours| \\}{}
    \ifdefmeta{epreuve}
        {|epreuve| \\}{}
    \ifdefmeta{session}
        {|session|  \\}{}
    \ifsolution
        \ifdefmeta{auteur}
            {\par \vskip\glueexpr\bigskipamount*2
            |auteur| \\ 
            \ifdefmeta{email}{|email| \\}{}
            \ifdefmeta{website}{|website| \\}{}
        }{}
    \fi 
}
\cpgesettitle*{
    \null\vskip\z@ plus .5fill
    |document| 
    \bigskip\hrule\bigskip
        |concours|
        |epreuve|
        |session|  \par \vskip \glueexpr 2\bigskipamount plus 1fill 
    \ifsolution 
        \ifdefmeta{auteur}{|auteur| |email| |website|}{} 
    \fi
}
% \cpgesetuptitle{
%     late after* =   \tableofcontents,
%     late after  =   \vskip \z@ plus .5fill
%                      \tableofcontents 
%                       \vskip \z@ plus 1fill
% }
\long\def\centralebox#1{%
    \tikz \node [draw, rounded corners=5pt, inner sep=8pt] {#1};%
}
\long\def\genboxcmd#1{%
    \tikz [baseline, anchor=base] \node [draw, rounded corners=3pt, inner sep=3pt, inner xsep=5pt] {#1};%
}
\let\listbox\default@listbox
\cpgesetdeco*{formula}{\centralebox}
\cpgesetdeco*{result}{\centralebox}
\cpgesetuplists{
    enumi={
        n=Q|1|, 
        d={\bfseries#1.},
        a=l,
        m*, 
        s=8pt plus 2pt minus 4pt,
    },
    itemi = {d={}--{} , m = 2em, s = 6pt }
}
\cpgesetupsectiontitle{
    problem={
        font = \Large\sffamily\bfseries,
        label deco = \ifisasolution#1\fi,
        deco = \Large\bfseries\itshape #1,
        fill = center, 
        spacing = {\z@}{\z@}{*6}
    },
    parti={
            font=\Large\bfseries,
            label=|I|,
            label deco=\bfseries #1\enskip,
            fill=right,
            spacing={\z@}{*5}{*3}
        },
    partii={
            font=\large\bfseries,
            label=|A|,
            label deco=\bfseries\itshape #1\ - \ ,
            deco = \bfseries\slshape #1\enskip,
            fill=right,
            spacing={\z@}{*3}{*1.5}
        },
    bigques={
        shape=block,
        fill=r,
        font=\bfseries\itshape\boldmath,
        label=|P|.|A|,
        spacing={\z@}{*3}{*1}
    }
} 
\cpgesetupmath{
    symbol={
        C=\mathbb C,
        R=\mathbb R, 
        Q=\mathbb Q,
        Z=\mathbb Z,
        N=\mathbb N,
        P=\mathbb P,
        E=\mathbb E,
        V=\mathbb V
    }
}
\@esphack}
\renewpagestyle{plain}[\fontsize{8}{8}\sffamily\scshape]{%
   \renewcommand\makeheadrule{}
   \renewcommand\makefootrule{}
   \sethead{}{}{}
   \setfoot{}{page \thepage{}}{}
 }
\renewpagestyle{main}[\fontsize{8}{8}\sffamily\scshape]{%
   \renewcommand\makeheadrule{\csuse{head@rule}}
   \renewcommand\makefootrule{\csuse{foot@rule}}
   \sethead{}{}{}
   \setfoot{}{}{\hf@page}
  }