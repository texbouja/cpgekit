\def\filedate{2023/22/12}
\def\fileversion{v0.2alpha}
\def\fileauthor{Sadik Boujaida}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{igcours}[\filedate\space\fileversion]

\RequirePackage{pgfopts}
\RequirePackage{etoolbox}


\ifundef{\ifsolution}{\newif\ifsolution}{}
\ifundef{\ifproof}{\newif\ifproof}{}
\ifundef{\ifdraf}{\newif\ifdraft}

\pgfkeys{/IGPC/.is family, /IGPC/.cd,
	proof/.is if=proof,
	solution/.is if=solution,
	draft/.is if=draft
}
\ProcessPgfOptions{/IGPC}

\ifundef{\igset}{
	\pgfkeys{/ig/.is family}
	\DeclareDocumentCommand\igset{o}{%
		\IfValueT{#1}
			{\pgfkeysifdefined{/ig/#1/.is family}{}{\pgfkeys{/ig/#1/.is family}}}%
		\IfValueTF{#1}{\pgfqkeys{/ig/#1}}{\pgfqkeys{/ig}}%
	}
	\pgfkeys{/handlers/.colorlet/.code=
		\pgfkeysalso{\pgfkeyscurrentpath/.code=\colorlet{#1}{##1}}}
	}{}
\ifundef{\tcbset}{
	\RequirePackage{tcolorbox}
}{}
\tcbuselibrary{breakable,theorems,xparse}
\usetikzlibrary{calc}
\tcbset{maincol/.code=\colorlet{maincol}{#1}}

\tcbset{%
	primary box/.style={%
		breakable,
		lines before break=1,
		height fixed for=first and middle,
		title style if break,
		fonttitle=\TitlingFont\footnotesize\vphantom{(},
		description font=\scshape\footnotesize\vphantom{(},
		colback=bgcol,coltext=fgcol
	},
	secondary box/.style={%
		reset, blank,
		notitle,
		colback=bgcol,
		coltext=fgcol
	}
}
\tcbset{%
	every box on layer 1/.style={primary box},
	every box on layer 2/.style={secondary box},
	every box on layer 3/.style={secondary box},
	every box on layer 4/.style={secondary box}
}
%\tcbsetmanagedlayers{2}

\igset{simple deco/.code={%
			\igdefdeco{simple}{\simple@label@font#1}%
			\let\deco@lrmargin\deco@simple},
	   simple label font/.code={\def\simple@label@font{#1\vphantom{(}}},
}
\igset{%
	simple deco=\textcolor{maincol}{\fbox{#1}}\enskip,
	simple label font=\scshape\sffamily\footnotesize,
}
\igset[mini]{
	left margin=1pc,
	right margin=0pt,
	font=\sffamily\footnotesize
	}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% Mise en place des differents types de theoremes %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newif\ifexo@type
\newif\iftheo@type
\newif\ifdef@type
\newif\ifrem@type
\newif\ifproof@type
\igset{theorem type/.is choice,
	 theorem type/exercise/.code={\rem@typefalse},
	 theorem type/theorem/.code={\rem@typefalse},
	 theorem type/definition/.code={\rem@typefalse},
	 theorem type/remark/.code={\rem@typetrue},
	 theorem type/proof/.code={\rem@typetrue}
 }
\tcbset{theorem type/.is choice,
	 theorem type/exercise/.code={\exo@typetrue},
	 theorem type/theorem/.code={\theo@typetrue},
	 theorem type/definition/.code={\def@typetrue},
	 theorem type/remark/.code={\rem@typetrue},
	 theorem type/proof/.code={\proof@typetrue},
 }
\tcbset{new/within chapter or section/.code=%
		{%
		\ifchapter@in@class
			\tcbset{new/number within=chapter}
		\else
			\tcbset{new/number within=section}
		\fi}
}
\ig@cnt@shortcut{*X}{current@counter}
\igset[theorems]{%
	theorem style/.code=%
		\tcbset{theorem style/.style={%
			maincol=warmcol,colbacktitle=maincol,#1,current counter=\thetcbcounter}},
	definition style/.code=%
		\tcbset{definition style/.style={%
			maincol=coldcol,colbacktitle=maincol,#1,current counter=\thetcbcounter}},
	remark style/.code=%
		\tcbset{remark style/.style={%
			maincol=neutralcol, colbacktitle=maincol,#1,current counter=\thetcbcounter}},
	}
\ifserie
\igset[theorems]{
	exercise style/.code=%
		\tcbset{exercise style/.style={maincol=warmcol, colbacktitle=maincol,#1}}
}
\else
\igset[theorems]{
	exercise style/.code=%
		\tcbset{exercise style/.style={maincol=importantcol, colbacktitle=maincol,#1}}
}
\fi
\def\igsettheoremstyle{\pgfqkeys{/ig/theorems}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%% Gestion des demos et des solutions %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Enregistrement des demo/solutions dans des fichiers individuels 
%%% et creation des hyperliens.
%%% Une token list contient la liste des commandes d'inclusion 
%%% des fichiers crées. 
%%% si les fichiers doivent être inclu en fin du fichier en cours
%%% la token list est exécutée (et vidée) sinon son contenu
%%% est ajouté à un fichier record. Celui-ci peut être inclu ensuite
%%% par l'utilisateur à un endroit de son choix.  

\def\out@dir{output}
\def\aux@dir{tmp}
\def\draft@solution{%
	\closeunite%
	\tcbsubtitle[basic subtitle]{Solution}%
	\set@defaultforlistsinsideunite%
}
\def\draft@proof{%
	\closeunite%
	\tcbsubtitle[basic subtitle]{D\'emonstration}%
	\set@defaultforlistsinsideunite%
}
\tcbset{basic subtitle/.style={%
		spartan,
		coltext=white,
		colback=maincol,
		colbacktitle=maincol,
		boxrule=0pt,
		boxsep=0pt,
		top=.8pt,
		bottom=.8pt
	}
}


\IfFileExists{/dev/null}
		{\immediate\write18{mkdir -p \aux@dir}}
		{\immediate\write18{md  "\aux@dir"}}%

%% Styles des hyperliens demo/solution
\AtBeginDocument{
	\ifprint
	\tcbset{demolink/.style n args={3}{% 
		size=#1, arc=#2, boxrule=2pt,
		colframe=bgcol, coltext=linkcol!75!black, colback=bgcol, #3}}
	\else
	\tcbset{demolink/.style n args={3}{%
		size=#1, arc=#2, boxrule=2pt,
		colframe=bgcol, coltext=white, colback=linkcol!75!black, #3
		}}
	\fi
}
%%% Lien vers demo/solution en bas d'un énoncé.  
\def\@demolink#1#2{%
	\par\nopagebreak\vskip-\baselineskip%
	\vbox to\z@{\null\hfill\tcbox[
			reset, enhanced, nobeforeafter,
			demolink={tight}{3.2pt}{},
			hyperlink={#1@\thetcbcounter}, 
		]
		{\null\hskip10pt\sffamily\fontsize{8}{8}\scshape\vphantom{(3} #2 \thetcbcounter, page \pageref*{#1@\thetcbcounter}\hskip10pt\null}
}}
\def\@titledemolink#1#2#3#4#5#6{
	\par\penalty-999\bigskip
		\@hangfrom{
			\tcbox[
				enhanced,tcbox raise base,
				%enlarge left by=-8pt,
				demolink={small}{8pt}{colframe=linkcol, boxrule=.4pt},
				hyperlink={#1:#2},
				hypertarget={#4@#2},
  				phantomlabel={#4@#2},
  			]
	{\null\hskip6pt\sffamily\scshape\small\vphantom{)}#5 #3~#2\hskip6pt\null}\enskip}%
	\ifblank{#6}{}{\textsc{\small (#6)}}%
	\vrule width \z@  depth\bigskipamount%
	\par\penalty\@M%
}
\def\@recsol{%
	\edef\igc@tmpe{%
		\the\toks@sol%
		\noexpand\solu%
			{\ig@theorem@prefix}%
			{\thetcbcounter}%
			{\igdu@theorem@name}%
			{\@theotitle}%
			{\aux@dir/sol-\thetcbcounter}^^J%
	}
	\expandafter\global\expandafter\toks@sol\expandafter{\igc@tmpe}%
}
\def\@recprv{%
	\edef\igc@tmpe{%
		\the\toks@prv%
		\noexpand\preuve%
			{\ig@theorem@prefix}%
			{\thetcbcounter}%
			{\igdu@theorem@name}%
			{\@theotitle}%
			{\aux@dir/prv-\thetcbcounter}^^J%
	}%
	\expandafter\global\expandafter\toks@prv\expandafter{\igc@tmpe}%
}
\ifdraft
	\let\solution\draft@solution
	\let\proof\draft@proof
	\tcbset{%
		with@solu/.style={},
		with@proof/.style={},
	}
\else 
\def\proof@link{\ifproof\@demolink{proof}{d\'emonstration}\fi}
\def\solution@link{\ifsolution\@demolink{solution}{solution}\fi}
\tcbset{%
    with@solu/.style={%
        lowerbox=ignored,
        before upper app=\def\solution{\@recsol\solution@link\tcblower},
        savelowerto=\aux@dir/sol-\thetcbcounter.tex,
      },
    with@proof/.style={%
       	lowerbox=ignored,
        before upper app=\def\proof{\@recprv\proof@link\tcblower},
        savelowerto=\aux@dir/prv-\thetcbcounter.tex,
      },
}
\fi 
\tcbset{%
	proof or solution/.code=%
		\ifexo@type\tcbset{with@solu}\fi
		\iftheo@type\tcbset{with@proof}\fi
	}

%%%%% Boites pour les demo/solutions	
\NewDocumentCommand{\solution@push}{mmmmm}{%
	\@titledemolink{#1}{#2}{#3}{solution}{solution}{#4}
  	\begingroup%
		\set@defaultforlistsinsideunite
 		\input{#5}%
		\closeunite%
	\endgroup%
}
\NewDocumentCommand{\proof@push}{mmmmm}{%
	\@titledemolink{#1}{#2}{#3}{proof}{démonstration}{#4}
  	\begingroup%
		\set@defaultforlistsinsideunite
 		\input{#5}%
		\closeunite%
	\endgroup%
}
\def\preuve#1#2#3#4#5{}
\def\solu#1#2#3#4#5{}

%%%% Stratégie d'inclusion de fichier de contenu

\igset{solutions/.is family, solutions,
	solution/.is if=solution,
	solution*/.is if=solutiondelayed,
	proof/.is if=proof,
	proof*/.is if=proofdelayed,
	solution title/.code 2 args=\def\sol@section{\csuse{#1}{#2}},
	solution title/.default={section}{Solutions des exercices},
	proof title/.code 2 args=\def\prv@section{\csuse{#1}{#2}},
	proof title/.default={section}{D\'emonstrations des th\'eor\`emes},
	solution title, proof title
	}% 
\DeclareDocumentCommand\iginclude{O{} m}{%%
	\begingroup%
		\RenewDocumentCommand\titre{sod()}{}%
		\ifdraft
			\subdoc{#2}
		\else
			\IfValueT{#1}{\igset[solutions]{#1}}%
			\ifsolutiondelayed\solutiontrue\fi
			\ifproofdelayed\prooftrue\fi
			\subdoc{#2}%
			\edef\ig@tmpe{\the\toks@prv}
			\ifproofdelayed
				\ifrecord@active\else\tcbstartrecording[\jobname.rec]\fi
				\tcbrecord{\expandonce\ig@tmpe}
			\else
				\ifproof
					\ifdefvoid\ig@tmpe{}{\typeoutdemonstrations}
				\fi
			\fi 
			\edef\ig@tmpe{\the\toks@sol}
			\ifsolutiondelayed
				\ifrecord@active\else\tcbstartrecording[\jobname.rec]\fi
				\tcbrecord{\expandonce\ig@tmpe}
			\else
				\ifsolution
					\ifdefvoid\ig@tmpe{}{\typeoutsolutions}
				\fi
			\fi 
	\endgroup%
}
\def\typeoutsolutions{%
	\clearpage%
	\sol@section
	\begingroup\let\solu\solution@push\ig@tmpe\endgroup%
}
\def\typeoutdemonstrations{%
	\clearpage%
	\prv@section
	\begingroup\let\preuve\proof@push\ig@tmpe\endgroup%
}
\def\solutions{%
	\ifrecord@active\tcbstoprecording\record@activefalse\fi
	\IfFileExists{\jobname.rec}
		{
			\sol@section
			\begingroup\let\solu\solution@push\input{\jobname.rec}\endgroup
		}
}
\def\demonstrations{%
	\ifrecord@active\tcbstoprecording\record@activefalse\fi
	\IfFileExists{\jobname.rec}
		{
			\prv@section
			\begingroup\let\preuve\proof@push\input{\jobname.rec}\endgroup
		}
}
\AtEndDocument{\ifrecord@active\tcbstoprecording\fi}

\tcbset{no@countertoolargemessage/.code={\let\@ctrerr\relax},
	no@countertoolargemessage
	}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% Définition des environnements pour théroremes %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% macros et cles principales de creation de theorem
\tcbset{%
	font app/.code 2 args={\csappto{kvtcb@font#1}{#2}},
	font reset/.code 2 args={\csdef{kvtcb@font#1}{#2}}
}
\def\kvtbc@titlewho{\ifdefempty{\kvtcb@title}{\tcbtitletext}{\kvtcb@title}}
\tcbset{title style if break/.style={%%
	title after break={\MakeLowercase{\kvtbc@titlewho}~(suite)},
	extras title after break={%
		halign title=right,
		coltitle=maincol,
		colbacktitle=bgcol,
		colback=bgcol,
		boxsep=0pt, top =0pt, bottom=0pt, left=3pt,right=3pt,
		font app={title}{\fontsize{7}{7}\mdseries\itshape}
		},
	extras middle and last={colbacktitle=bgcol},
	bottomrule=1pt, 
	bottomrule at break=1pt,
	toprule at break=0pt,
	titlerule=0pt
}}

\tcbset{%
		@theoprefix/.store in=\ig@theorem@prefix,
		@theoname/.store in=\ig@theorem@name,
		du@theoname/.store in=\igdu@theorem@name,
		@demoname/.store in=\ig@demo@name
	}
\ifdraft
\tcbset{description path/.style={
		after title={\enskip\mdseries\scshape\itshape\small (#1)},
	}}
\else
\tikzset{description path style/.style={%
				fill=maincol,
				draw=none,
				font=\smaller{-2}\vphantom{(},
				text=tcbcoltitle,
				#1}}
\tcbset{description path/.style={%
	overlay unbroken and first={%
    	\path let \p1=(title.north east), \p2=([xshift=-12pt]frame.north east) in
			node (description) [%
        		anchor=west ,
				xshift=2pt , inner ysep=1pt ,
				text width=\x2-\x1 ,
				description path style
				] 
			at (title.east) {#1} ;
  		}
}}
\fi 

\def\important@message{\ifexo@type exercice \else r\'esultat\fi{} important}
\tcbset{
	important/.style={%
		maincol=importantcol,
		bottom=10pt,
		underlay unbroken and last={\node at (frame.south west) 
			[text=maincol, 
			font=\fontsize{7}{8}\selectfont, 
			anchor=south west, 
			yshift=2pt
			] 
			{#1};}
		},
	important/.default=\important@message
}
\igset[math]{
	formula/.code=\igdefdeco{formula}{#1},
	result/.code=\igdefdeco{result}{#1},
	formula={\fcolorbox{maincol}{tcbcolback}{#1}},
	result={\fcolorbox{maincol}{tcbcolback!95!maincol}{#1}}
}
%%% Environnement butineur : tous les environnement 
%%% de theoreme l'utilisent en interne
\def\ig@theo@form@namenumber#1#2{\hbox{#1~#2}}
\def\ig@theo@form@numbername#1#2{\hbox{#2~#1}}
\def\ig@theo@form@name#1#2{\hbox{#1}}
\tcbset{%
	theorem name and number/.code={\let\tcb@theo@form=\ig@theo@form@namenumber},
	theorem number and name/.code={\let\tcb@theo@form=\ig@theo@form@numbername},
	theorem name/.code={\let\tcb@theo@form=\ig@theo@form@name},
	new/@labelformat/.code 2 args=\labelformat{#1}{#2}
}
\def\@theotitle{}
\NewDocumentCommand{\ig@new@tcbtheorem}{O{} mmmmm}{%
  \igset{theorem type=#5}%
  \unless\ifrem@type
  \@@newtcolorbox[auto counter, list inside=theo,#1]{#2}{O{} d() d<>}{%
  	@theoname=\detokenize{#3},
	du@theoname=\detokenize{#4},
    theorem type=#5,
    #5 style,
    theorem name and number,
	@theoprefix=#2,
    title={\ig@tcb@theo@title{#3}{\thetcbcounter}},%
    IfValueT={##2}{list entry=%
    	{\protect\numberline{\thetcbcounter}#3~:~##2}},%
    IfValueT={##2}{nameref={##2},description path={##2}, code=\def\@theotitle{##2}},%
    IfValueT={##3}{label={##3}},%
	hypertarget={\ig@theorem@prefix:\thetcbcounter},
	proof or solution,
    #6,##1}%
    \fi
    \ifrem@type
    \@@newtcolorbox[auto counter, list inside=theo,#1]{#2}{O{} d() d<>}{%
    remark style, 
    theorem name and number,
	@theoprefix=#2,
    title={\ig@tcb@theo@title{#3}{\thetcbcounter}
    		\IfValueTF{##2}{\enskip\mdseries\itshape({##2})}{}},%
    IfValueTF={##2}{list entry=%
    	{\protect\numberline{\thetcbcounter}#3~:~##2}}{},%
    IfValueTF={##2}{nameref={##2}}{},%
    IfValueTF={##3}{label={##3}}{},%
    #6,##1,
    colframe=maincol
    }%
	\fi
	\ifrem@type\else
    \DeclareDocumentEnvironment{#2+}{}
    	{\csname #2\endcsname}
		{\csname end#2\endcsname}
	\fi
	\DeclareDocumentEnvironment{#2*}{O{} d() d<>}
    	{\csname #2\endcsname [##1,theorem name](##2)<##3>}
		{\csname end#2\endcsname}
	\rem@typefalse
	}
	
\ifchapter@in@class	
	\newcounter{genthm}[chapter]
\else
	\newcounter{genthm}
\fi
\NewTColorBox[use counter=genthm]{genthm*}{O{} m d() d<>}{%
	title={#2},
	IfValueT={#3}{description path={#3}},
	IfValueT={#4}{nameref={#3}},
	maincol=coldcol,
	theorem style,
	theorem name,
	titled items,
	#1}
\NewTColorBox[use counter=genthm]{genthm}{O{} m d() d<>}{%
	IfValueTF={#2}{title={\ig@tcb@theo@title{#2}{\thetcbcounter}}}{},
	IfValueTF={#3}{nameref={#3}, description path={#3}}{},
	IfValueTF={#4}{label={#4}}{},
	IfValueTF={#3}{list entry=%
    	{\protect\numberline{\thetcbcounter}#2~:~#3}}{},%
	maincol=coldcol,
	theorem style,
	theorem name,
	titled items,
	#1}
\tcbset{marge/.style={left=#1,right=#1}}	
	
%%%%%%%% Tables des théorèmes 
\def\ig@tcb@theo@title#1#2{%
	\ifdefempty{#2}
		{\setbox\z@=\color@hbox#1~\color@endbox}
  		{\setbox\z@=\tcb@theo@form{#1}{#2}}%
	\unhbox\z@%
}

\def\ig@addcontentsline#1#2{%
	\ifx\kvtcb@listentry\@empty\else
    	\addcontentsline{#1}{#2}{\kvtcb@listentry}%
	\fi%
}

\def\ignewtheorem{\let\tcb@addcontentsline\ig@addcontentsline%
	\let\@@newtcolorbox\NewTColorBox%
	\ig@new@tcbtheorem}

\def\igrenewtheorem{\let\@@newtcolorbox\RenewTColorBox%
  \ig@new@tcbtheorem}
  
\ProvideDocumentCommand\tableofresults%
	{O{\section*} D(){Liste des r\'esultats remarquables}}{%
		\tcblistof[#1]{theo}{#2}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% jeu de styles tcolorbox %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tcbset{minimal/.style=blanker}

\tcbset{simple/.style={%
	colframe=maincol,
	boxrule=.4pt,
	top=3pt,bottom=3pt,
	left=5pt,right=5pt
	}}
	
\tcbset{basic/.style={%
	spartan,
  	top=3pt,bottom=3pt,
	left=5pt,right=5pt,
	boxrule=.4pt, 
}}
\tcbset{
	basicthm/.style={%
		empty, 
		basic, 
		attach boxed title to top left={xshift=3pt,yshift*=-\tcboxedtitleheight+.1pt},
		boxed title style={%
					boxrule=0pt,
			boxsep=0pt,
			top=2pt,bottom=1pt,left=3pt,right=3pt,
		}
	}
}
\tcbset{%
	basicrmk/.style={
		blankest, 
		coltitle=maincol,
		top=3pt, bottomtitle=5pt, 
		left=20pt, before title={\hskip-14pt},
		borderline west={.6pt}{.6pt}{maincol}
	}
}
\tcbset{rounded/.style={
	arc=5pt,
    colframe=maincol,
    boxrule=-1pt,
	left=8pt,right=8pt
 }}
\tcbset{roundedthm/.style={%
	rounded,
    attach boxed title to top left={yshift=-\tcboxedtitleheight/2-1pt,xshift=3pt},
    boxed title style={%
    	arc=5pt,
        boxsep=0pt,
        top=2pt,bottom=1pt,left=6pt,right=6pt,
        boxrule=1pt,
        colframe=pagecol
        },
        bottomrule=.8pt
}}
\tcbset{uphill/.style={
    	colframe=maincol,
		left=5pt,right=5pt,
    	arc=.2cm,
    	sharp corners=uphill
 }}
\tcbset{uphillthm/.style={%
	uphill,
    attach boxed title to top left={yshift=-\tcboxedtitleheight},
    boxed title style={%
        boxsep=0pt,
        top=2pt,bottom=1pt,left=6pt,right=6pt,
        arc=.2cm,
        sharp corners=uphill
        },
        boxrule=.4pt,
 }}



%%% Theme par defaut (basic)		
\igsettheoremstyle{%
	theorem style=basicthm,
	definition style=basicthm,
	exercise style=basicthm,
	remark style=basicrmk 
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% style d'enumerations dans les theorem %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\let\thecurrent@counter\@gobble
\igsetenum{1}{marge}
\igsetenum{2}{marge*}
\igdeflabel{enumi}{|X|.|1|}%
\igdefdeco{enumi}{\deco@simple{#1}}%
\igdeflabel{enumii}{|Q|\itshape|a|}
\igdefdeco{enumii}{\bfseries #1.}
\igdeflabel{equation}{|X|\,--\,|1|}
\igdefdeco{itemtitle}{{\scshape\sffamily#1~:~}}
\igdefdeco{unitetitle}{\textcolor{maincol}{\sffamily\scshape\small#1~:~}}
\makethetolabel{equation}
\tcbset{%
	current counter/.code={\def\thecurrent@counter{#1}}
	}	
\tcbset{%
	titled items/.code={%
		\tcbset{after upper pre=\closeunite}%
		\set@defaultforlistsinsideunite%
}}
\igdefdeco{unite}{\textcolor{maincol}{\sffamily\small\scshape\bfseries#1.}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%% exemples d'environement pour theoremes %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ignewtheorem[within chapter or section, @labelformat={theo}{le théorème}]{theo}
	{Th\'eor\`eme}
	{du th\'eor\`eme}
	{theorem}
	{titled items}	
\ignewtheorem[use counter from=theo]{theodef}
	{Th\'eor\`eme et d\'efinition}
	{du th\'eor\`eme}
	{theorem}
	{titled items}
\ignewtheorem[use counter from=theo]{propdef}
	{Proposition et d\'efinition}
	{de la proposition}
	{theorem}
	{titled items}
\ignewtheorem[use counter from=theo]{prop}
	{Proposition}
	{de la proposition}
	{theorem}
	{titled items}
\ignewtheorem[use counter from=theo]{lemm}
	{Lemme}
	{du lemme}
	{theorem}
	{}
\ignewtheorem[use counter from=theo]{ppte}
	{Propri\'et\'es}
	{des propri\'et\'es}
	{theorem}
	{titled items}
\ignewtheorem[use counter from=theo]{coro}
	{Corollaire}
	{du corollaire}
	{theorem}
	{titled items}
\ignewtheorem[within chapter or section]{defi}
	{D\'efinition}
	{}
	{definition}
	{titled items}
\ignewtheorem[use counter from=defi]{voca}
	{Vocabulaire}
	{}
	{definition}
	{theorem name, titled items}
\ignewtheorem[use counter from=defi]{nota}
	{Notations}
	{}
	{definition}
	{theorem name,titled items}
\ignewtheorem[within chapter or section]{rema}
	{Remarque}
	{}
	{remark}
	{}
\ignewtheorem[use counter from=rema]{remas}
	{Remarques}
	{}
	{remark}
	{titled items}
\ignewtheorem[use counter from=rema]{remap}
	{Remarques pratiques}
	{}
	{remark}
	{titled items}
\ignewtheorem[within chapter or section]{exem}
	{Exemples}
	{}
	{remark}
	{titled items}
\ignewtheorem[use counter from=exem]{exemf}
	{Exemples fondamentaux}
	{}
	{remark}
	{titled items}
\ignewtheorem[use counter from=exem]{exema}
	{Exemple d'application}
	{}
	{remark}
	{titled items}
\ignewtheorem[use counter from=exem]{exemp}
	{Exemple pratique}
	{}
	{remark}
	{titled items}
\ignewtheorem[within chapter or section]{prob}
	{Probl\`eme}
	{du probl\`eme}
	{exercise}
	{}
\ignewtheorem[no counter]{demo}
	{D\'emonstration}
	{}
	{proof}
	{titled items, current counter=\@gobble}
\ignewtheorem[within chapter or section]{float}
	{Figure}
	{}
	{remark}
	{float, halign title=flush center}
\tcbset{floatplacement=tbp}
\ifserie
 	\igdefcounter{igexer}{}(E)<l'exercice>
    \ignewtheorem[use counter=igexer]{exer}
    	{Exercice}
    	{de l'exercice}
    	{exercise}
    	{titled items}
\else
	\ignewtheorem[within chapter or section,@labelformat={tcb@cnt@exer}{l'exercice}]{exer}
		{Exercice}
		{de l'exercice}
		{exercise}
		{titled items}
	\ignewtheorem[within chapter or section]{exappli}
		{Exercice d'application}
		{de l'exercice}
		{exercise}
		{titled items}
	\ignewtheorem[within chapter or section]{exappro}
		{Exercice d'approfondissement}
		{de l'exercice}
		{exercise}
		{titled items}
\fi

\endinput
